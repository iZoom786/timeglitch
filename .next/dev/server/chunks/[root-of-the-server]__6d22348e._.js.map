{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///E:/supavids/pages/api/news.js"],"sourcesContent":["// pages/api/news.js\r\nimport path from \"path\";\r\n\r\n// Load environment variables\r\nconst envPath = path.join(process.cwd(), \".env.local\");\r\nrequire(\"dotenv\").config({ path: envPath });\r\n\r\nexport default async function handler(req, res) {\r\n  // Set CORS headers\r\n  res.setHeader('Access-Control-Allow-Origin', '*');\r\n  res.setHeader('Access-Control-Allow-Methods', 'GET, POST, PUT, DELETE, OPTIONS');\r\n  res.setHeader('Access-Control-Allow-Headers', 'Content-Type, Authorization');\r\n  \r\n  // Handle preflight requests\r\n  if (req.method === 'OPTIONS') {\r\n    res.status(200).end();\r\n    return;\r\n  }\r\n  \r\n  try {\r\n    // Use New York Times Archive API key\r\n    const NY_TIMES_API_KEY = process.env.NY_TIMES_API_KEY || \"\";\r\n    \r\n    if (!NY_TIMES_API_KEY) {\r\n      return res.status(500).json({ error: \"New York Times API key not configured\" });\r\n    }\r\n    \r\n    // Generate a random date within the specified range (1895 to 1999)\r\n    const randomYear = 1895 + Math.floor(Math.random() * (1999 - 1895 + 1));\r\n    const randomMonth = Math.floor(Math.random() * 12) + 1;\r\n    \r\n    // Fetch news from New York Times Archive API\r\n    const url = `https://api.nytimes.com/svc/archive/v1/${randomYear}/${randomMonth}.json?api-key=${NY_TIMES_API_KEY}`;\r\n    \r\n    // Use native fetch if available, otherwise import node-fetch\r\n    let fetchImpl;\r\n    if (typeof fetch !== 'undefined') {\r\n      fetchImpl = fetch;\r\n    } else {\r\n      const nodeFetch = await import('node-fetch');\r\n      fetchImpl = nodeFetch.default;\r\n    }\r\n    \r\n    const apiResponse = await fetchImpl(url);\r\n    \r\n    if (!apiResponse.ok) {\r\n      const errorText = await apiResponse.text();\r\n      return res.status(apiResponse.status).json({ error: `NYT Archive API request failed: ${errorText}` });\r\n    }\r\n    \r\n    const data = await apiResponse.json();\r\n    \r\n    // Transform NYT data to match the expected format\r\n    const transformedData = {\r\n      status: \"ok\",\r\n      articles: []\r\n    };\r\n    \r\n    // Extract articles from NYT response\r\n    if (data.response && data.response.docs && Array.isArray(data.response.docs)) {\r\n      transformedData.articles = data.response.docs.map(doc => ({\r\n        title: doc.headline ? doc.headline.main : \"Untitled Article\",\r\n        description: doc.snippet || \"No description available\",\r\n        pub_date: doc.pub_date || new Date().toISOString(),\r\n        url: doc.web_url || \"\",\r\n        // Include the full article content from the \"main\" section\r\n        content: doc.lead_paragraph || doc.abstract || doc.snippet || \"\"\r\n      }));\r\n    }\r\n    \r\n    return res.status(200).json(transformedData);\r\n  } catch (e) {\r\n    console.error(\"API Error:\", e);\r\n    return res.status(500).json({ error: String(e.message || e) });\r\n  }\r\n}"],"names":[],"mappings":"AAAA,oBAAoB;;;;;AACpB;;AAEA,6BAA6B;AAC7B,MAAM,UAAU,4GAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,IAAI;AACzC,uEAAkB,MAAM,CAAC;IAAE,MAAM;AAAQ;AAE1B,eAAe,QAAQ,GAAG,EAAE,GAAG;IAC5C,mBAAmB;IACnB,IAAI,SAAS,CAAC,+BAA+B;IAC7C,IAAI,SAAS,CAAC,gCAAgC;IAC9C,IAAI,SAAS,CAAC,gCAAgC;IAE9C,4BAA4B;IAC5B,IAAI,IAAI,MAAM,KAAK,WAAW;QAC5B,IAAI,MAAM,CAAC,KAAK,GAAG;QACnB;IACF;IAEA,IAAI;QACF,qCAAqC;QACrC,MAAM,mBAAmB,QAAQ,GAAG,CAAC,gBAAgB,IAAI;QAEzD,IAAI,CAAC,kBAAkB;YACrB,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;gBAAE,OAAO;YAAwC;QAC/E;QAEA,mEAAmE;QACnE,MAAM,aAAa,OAAO,KAAK,KAAK,CAAC,KAAK,MAAM,KAAK,CAAC,OAAO,OAAO,CAAC;QACrE,MAAM,cAAc,KAAK,KAAK,CAAC,KAAK,MAAM,KAAK,MAAM;QAErD,6CAA6C;QAC7C,MAAM,MAAM,CAAC,uCAAuC,EAAE,WAAW,CAAC,EAAE,YAAY,cAAc,EAAE,kBAAkB;QAElH,6DAA6D;QAC7D,IAAI;QACJ,IAAI,OAAO,UAAU,aAAa;YAChC,YAAY;QACd,OAAO;YACL,MAAM,YAAY;YAClB,YAAY,UAAU,OAAO;QAC/B;QAEA,MAAM,cAAc,MAAM,UAAU;QAEpC,IAAI,CAAC,YAAY,EAAE,EAAE;YACnB,MAAM,YAAY,MAAM,YAAY,IAAI;YACxC,OAAO,IAAI,MAAM,CAAC,YAAY,MAAM,EAAE,IAAI,CAAC;gBAAE,OAAO,CAAC,gCAAgC,EAAE,WAAW;YAAC;QACrG;QAEA,MAAM,OAAO,MAAM,YAAY,IAAI;QAEnC,kDAAkD;QAClD,MAAM,kBAAkB;YACtB,QAAQ;YACR,UAAU,EAAE;QACd;QAEA,qCAAqC;QACrC,IAAI,KAAK,QAAQ,IAAI,KAAK,QAAQ,CAAC,IAAI,IAAI,MAAM,OAAO,CAAC,KAAK,QAAQ,CAAC,IAAI,GAAG;YAC5E,gBAAgB,QAAQ,GAAG,KAAK,QAAQ,CAAC,IAAI,CAAC,GAAG,CAAC,CAAA,MAAO,CAAC;oBACxD,OAAO,IAAI,QAAQ,GAAG,IAAI,QAAQ,CAAC,IAAI,GAAG;oBAC1C,aAAa,IAAI,OAAO,IAAI;oBAC5B,UAAU,IAAI,QAAQ,IAAI,IAAI,OAAO,WAAW;oBAChD,KAAK,IAAI,OAAO,IAAI;oBACpB,2DAA2D;oBAC3D,SAAS,IAAI,cAAc,IAAI,IAAI,QAAQ,IAAI,IAAI,OAAO,IAAI;gBAChE,CAAC;QACH;QAEA,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;IAC9B,EAAE,OAAO,GAAG;QACV,QAAQ,KAAK,CAAC,cAAc;QAC5B,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;YAAE,OAAO,OAAO,EAAE,OAAO,IAAI;QAAG;IAC9D;AACF"}}]
}