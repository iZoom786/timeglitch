{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///E:/supavids/pages/api/news.js"],"sourcesContent":["// pages/api/news.js\r\nimport path from \"path\";\r\n\r\n// Load environment variables\r\nconst envPath = path.join(process.cwd(), \".env.local\");\r\nrequire(\"dotenv\").config({ path: envPath });\r\n\r\nlet fetchFn = global.fetch;\r\ntry { \r\n  if (!fetchFn) {\r\n    // Dynamically import node-fetch for server-side\r\n    fetchFn = (...args) => import('node-fetch').then(({default: fetch}) => fetch(...args));\r\n  }\r\n} catch (_) {}\r\n\r\nexport default async function handler(req, res) {\r\n  try {\r\n    // For NewsAPI free tier, we'll only fetch articles from the last week\r\n    const NEWS_API_KEY = process.env.NEWS_API_KEY || \"\";\r\n    \r\n    if (!NEWS_API_KEY) {\r\n      return res.status(500).json({ error: \"News API key not configured\" });\r\n    }\r\n    \r\n    // Calculate date range for last week\r\n    const today = new Date();\r\n    const oneWeekAgo = new Date(today.getTime() - 7 * 24 * 60 * 60 * 1000);\r\n    \r\n    const toDate = today.toISOString().split('T')[0];\r\n    const fromDate = oneWeekAgo.toISOString().split('T')[0];\r\n    \r\n    // Fetch news from NewsAPI for the last week\r\n    const url = `https://newsapi.org/v2/everything?q=usa&from=${fromDate}&to=${toDate}&sortBy=popularity&apiKey=${NEWS_API_KEY}&pageSize=20`;\r\n    \r\n    // Use dynamic import for node-fetch if needed\r\n    const fetch = typeof fetchFn === 'function' && fetchFn.constructor.name === 'AsyncFunction' \r\n      ? await fetchFn() \r\n      : fetchFn;\r\n      \r\n    const apiResponse = await fetch(url);\r\n    \r\n    if (!apiResponse.ok) {\r\n      const errorText = await apiResponse.text();\r\n      return res.status(apiResponse.status).json({ error: `News API request failed: ${errorText}` });\r\n    }\r\n    \r\n    const data = await apiResponse.json();\r\n    return res.status(200).json(data);\r\n  } catch (e) {\r\n    console.error(\"API Error:\", e);\r\n    return res.status(500).json({ error: String(e.message || e) });\r\n  }\r\n}"],"names":[],"mappings":"AAAA,oBAAoB;;;;;AACpB;;AAEA,6BAA6B;AAC7B,MAAM,UAAU,4GAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,IAAI;AACzC,uEAAkB,MAAM,CAAC;IAAE,MAAM;AAAQ;AAEzC,IAAI,UAAU,yDAAO,KAAK;AAC1B,IAAI;IACF,IAAI,CAAC,SAAS;QACZ,gDAAgD;QAChD,UAAU,CAAC,GAAG,OAAS,oGAAqB,IAAI,CAAC,CAAC,EAAC,SAAS,KAAK,EAAC,GAAK,SAAS;IAClF;AACF,EAAE,OAAO,GAAG,CAAC;AAEE,eAAe,QAAQ,GAAG,EAAE,GAAG;IAC5C,IAAI;QACF,sEAAsE;QACtE,MAAM,eAAe,QAAQ,GAAG,CAAC,YAAY,IAAI;QAEjD,IAAI,CAAC,cAAc;YACjB,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;gBAAE,OAAO;YAA8B;QACrE;QAEA,qCAAqC;QACrC,MAAM,QAAQ,IAAI;QAClB,MAAM,aAAa,IAAI,KAAK,MAAM,OAAO,KAAK,IAAI,KAAK,KAAK,KAAK;QAEjE,MAAM,SAAS,MAAM,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE;QAChD,MAAM,WAAW,WAAW,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE;QAEvD,4CAA4C;QAC5C,MAAM,MAAM,CAAC,6CAA6C,EAAE,SAAS,IAAI,EAAE,OAAO,0BAA0B,EAAE,aAAa,YAAY,CAAC;QAExI,8CAA8C;QAC9C,MAAM,QAAQ,OAAO,YAAY,cAAc,QAAQ,WAAW,CAAC,IAAI,KAAK,kBACxE,MAAM,YACN;QAEJ,MAAM,cAAc,MAAM,MAAM;QAEhC,IAAI,CAAC,YAAY,EAAE,EAAE;YACnB,MAAM,YAAY,MAAM,YAAY,IAAI;YACxC,OAAO,IAAI,MAAM,CAAC,YAAY,MAAM,EAAE,IAAI,CAAC;gBAAE,OAAO,CAAC,yBAAyB,EAAE,WAAW;YAAC;QAC9F;QAEA,MAAM,OAAO,MAAM,YAAY,IAAI;QACnC,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;IAC9B,EAAE,OAAO,GAAG;QACV,QAAQ,KAAK,CAAC,cAAc;QAC5B,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;YAAE,OAAO,OAAO,EAAE,OAAO,IAAI;QAAG;IAC9D;AACF"}}]
}